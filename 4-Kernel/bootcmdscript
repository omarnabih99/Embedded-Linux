
#load the zimage and dtb to kernel and fdt from SD card
setenv loadfrom_fat "fatload mmc 0:1 $kernel_addr_r zImage ; fatload mmc 0:1 $fdt_addr_r vexpress-v2p-ca9.dtb"

#load the image and dtb to kernel and fdt from tftp
setenv loadfrom_tftp "tftp $kernel_addr_r zImage ; tftp $fdt_addr_r vexpress-v2p-ca9.dtb"

#if the image and dtb are found -> it will print "kernel found"
setenv booting "if bootz $kernel_addr_r - $fdt_addr_r;then echo "Kernel Found";else echo "Kernel not found";fi"

#if the image and dtb are not found in the SD card -> load them from tftp / runbooting check
setenv load_image "if run loadfrom_fat ;then true ;else run loadfrom_tftp ;fi ; run booting"

#set boot arguments
#setenv bootargs "console=ttyAMA0 root=/dev/nfs ip=192.168.2.2:::::eth0 nfsroot=192.168.2.1:/home/omarnabih/rootfs,nfsvers=3,tcp rw init=/sbin/init"

#if the SD card is found -> echo dev found and load the image from the SD card
#if SD card is not found -> echo dev not found and load the image from tftp 
setenv bootcmd "if mmc dev; then echo "dev found"; run load_image; else echo "dev not found"; run loadfrom_tftp; run booting; fi"

#run bootcmd again
run bootcmd


